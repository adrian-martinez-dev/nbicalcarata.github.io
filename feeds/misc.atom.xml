<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Adrián Martínez - misc</title><link href="https://nbicalcarata.github.io/" rel="alternate"></link><link href="https://nbicalcarata.github.io/feeds/misc.atom.xml" rel="self"></link><id>https://nbicalcarata.github.io/</id><updated>2017-07-31T18:11:04-05:00</updated><entry><title>Tests de Selenium con servidor remoto y Vagrant</title><link href="https://nbicalcarata.github.io/tests-de-selenium-con-servidor-remoto-y-vagrant.html" rel="alternate"></link><published>2017-07-31T18:11:04-05:00</published><updated>2017-07-31T18:11:04-05:00</updated><author><name>Adrián Martínez</name></author><id>tag:nbicalcarata.github.io,2017-07-31:/tests-de-selenium-con-servidor-remoto-y-vagrant.html</id><summary type="html"></summary><content type="html">&lt;h2&gt;Servidor remoto&lt;/h2&gt;
&lt;p&gt;Con el entorno de desarrollo (neovim + tmux) ejecutándose en servidor remoto, habilitamos en éste el ssh tunneling de la siguiente forma:&lt;/p&gt;
&lt;p&gt;En el archivo &lt;code&gt;/etc/ssh/ssh_config&lt;/code&gt; modificamos la siguiente linea:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;GatewayPorts yes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reiniciamos el servicio ssh.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo systemctl restart sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Abrimos dos terminales en la maquina local, en la primera, iniciamos el ssh tunneling.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh -R 4444:localhost:4444 usuario@&amp;lt;ip-servidor&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En la segunda ejecutamos Selenium con Chromedriver.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;java -Dwebdriver.chrome.driver=&amp;#39;/home/adrian/chromedriver&amp;#39; -jar selenium-server-standalone-3.4.0.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En nuestro &lt;code&gt;behat.yml&lt;/code&gt;, &lt;code&gt;base_url&lt;/code&gt; debe apuntar a la IP de nuestro servidor y al puerto que tenemos abierto, donde se esta ejecutando nuestra aplicación de laravel con &lt;code&gt;php artisan serve&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;php artisan serve --host=&amp;lt;ip_servidor&amp;gt; --port=&amp;lt;puerto&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En &lt;code&gt;behat.yml&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;base_url: http://&amp;lt;ip_servidor&amp;gt;:&amp;lt;puerto&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Vagrant&lt;/h2&gt;
&lt;p&gt;Hacemos el ssh tunneling, pero sobre la dirección IP de homestead.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh -R 4444:localhost:4444 vagrant@192.168.10.10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En una terminal ejecutamos selenium y chromedriver como se indicó anteriormente:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;java -Dwebdriver.chrome.driver=&amp;#39;/home/adrian/chromedriver&amp;#39; -jar selenium-server-standalone-3.4.0.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En &lt;code&gt;behat.yml&lt;/code&gt;, en &lt;code&gt;base_url&lt;/code&gt; va indicada la url de nuestra aplicación, y en la sección de &lt;code&gt;selenium&lt;/code&gt;, &lt;code&gt;localhost:4000/wd/hub&lt;/code&gt; como si se ejecutara en la maquina virtual.&lt;/p&gt;
&lt;h3&gt;behat.yml&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;translation&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;locale&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;
    &lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;Laracasts&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Behat&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;env_path&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;behat&lt;/span&gt;
        &lt;span class="n"&gt;Behat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;MinkExtension&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;base_url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://interpos.app&amp;#39;&lt;/span&gt;
            &lt;span class="n"&gt;default_session&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;laravel&lt;/span&gt;
            &lt;span class="n"&gt;laravel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;
            &lt;span class="n"&gt;selenium2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
              &lt;span class="n"&gt;wd_host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;4444&lt;/span&gt;&lt;span class="sr"&gt;/wd/&lt;/span&gt;&lt;span class="n"&gt;hub&lt;/span&gt;
              &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;chrome&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En mi caso, usando el plugin &lt;a href="https://github.com/janko-m/vim-test"&gt;vim-test&lt;/a&gt;, &lt;code&gt;vagrant ssh&lt;/code&gt; no me permitía mandar el comando a ejecutar directamente a la maquina virtual, así que usando la función VagrantTransform (adaptada del ejemplo de la documentación) lo conseguí satisfactoriamente:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;!&lt;/span&gt; VagrantTransform&lt;span class="p"&gt;(&lt;/span&gt;cmd&lt;span class="p"&gt;)&lt;/span&gt; abort
  &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;l&lt;/span&gt;:vagrant_project &lt;span class="p"&gt;=&lt;/span&gt; fnamemodify&lt;span class="p"&gt;(&lt;/span&gt;getcwd&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:t&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cd ~/Homestead &amp;amp;&amp;amp; ssh -tt vagrant@192.168.10.10 &amp;quot;&lt;/span&gt;.shellescape&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cd /home/vagrant/sitios/&amp;#39;&lt;/span&gt;.vagrant_project.&lt;span class="s1"&gt;&amp;#39;; &amp;#39;&lt;/span&gt;.&lt;span class="k"&gt;a&lt;/span&gt;:cmd&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;endfunction&lt;/span&gt;

&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:test#custom_transformations &lt;span class="p"&gt;=&lt;/span&gt; {&lt;span class="s1"&gt;&amp;#39;vagrant&amp;#39;&lt;/span&gt;: &lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VagrantTransform&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;}
&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:test#transformation &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;vagrant&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="misc"></category><category term="behat"></category><category term="selenium"></category></entry><entry><title>Laravel Homestead en Fedora 26</title><link href="https://nbicalcarata.github.io/laravel-homestead-en-fedora-26.html" rel="alternate"></link><published>2017-06-29T17:15:59-05:00</published><updated>2017-06-29T17:15:59-05:00</updated><author><name>Adrián Martínez</name></author><id>tag:nbicalcarata.github.io,2017-06-29:/laravel-homestead-en-fedora-26.html</id><summary type="html"></summary><content type="html">&lt;h2&gt;Instalación&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ vagrant box add laravel/homestead
$ git clone https://github.com/laravel/homestead.git Homestead
$ cd Homestead
$ git checkout v5.4.0
$ bash init.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Homestead.yml&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;folders&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;sitios&lt;/span&gt;
      &lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vagrant&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitios&lt;/span&gt;
      &lt;span class="k"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;nfs&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;sites&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;interpos&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;
      &lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vagrant&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitios&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;interpos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;public&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;/etc/hosts&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;192.168.10.10  mysite.app
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Soporte NFS&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ vagrant plugin install vagrant-bindfs
$ sudo dnf install nfs-utils nfs-kernel-server firewall-config
$ sudo systemctl enable nfs-server
$ sudo systemctl start nfs-server
$ sudo firewall-cmd --permanent --add-service=nfs
$ sudo firewall-cmd --permanent --add-service=rpc-bind
$ sudo firewall-cmd --permanent --add-service=mountd
$ sudo firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Desde la versión 2.1.1 de &lt;code&gt;nfs-utils&lt;/code&gt; está deshabilitado el soporte a UDP por defecto, por lo que &lt;code&gt;vagrant up&lt;/code&gt;, se queda bloqueado en &lt;code&gt;==&amp;gt; homestead-7: Mounting NFS shared folders...&lt;/code&gt;, para resolver ésto, hay que editar &lt;code&gt;/etc/sysconfig/nfs&lt;/code&gt; y añadir &lt;code&gt;--udp&lt;/code&gt; a &lt;code&gt;RPCNFSDARGS&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;La anterior solución la encontré en este &lt;a href="https://robertbasic.com/blog/enable-udp-for-nfs-on-fedora/"&gt;enlace&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;RPCNFSDARGS=&amp;quot;--udp&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Virtualbox 5.1.24 &lt;a href="https://www.virtualbox.org/ticket/16911"&gt;bug&lt;/a&gt; workaround&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo ip link set vboxnet0 up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Firewall con GUI&lt;/h2&gt;
&lt;p&gt;Tomado de &lt;a href="https://meta.discourse.org/t/solved-nfs-mount-hangs-need-vagrant-file-for-fedora-23/41314/2"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Example for easily configuring firewalld using the &amp;quot;firewall-config&amp;quot; GUI:
- Choose &amp;quot;Configuration: Permanent&amp;quot; from the drop down menu
- Select the zone you want to modify (i chose &amp;quot;internal&amp;quot;).
- Go to the &amp;quot;Interfaces&amp;quot; tab, assign vboxnet0 (or other host-only adapter) to the zone.
- Go to the &amp;quot;Services&amp;quot; tab, check &amp;quot;mountd&amp;quot;, &amp;quot;nfs&amp;quot; and &amp;quot;rpc-bind&amp;quot;
- Go to the global &amp;quot;Services&amp;quot; tab (next to &amp;quot;Zones&amp;quot;), select NFS and add Port 2049 UDP (only TCP is predefined).
- Finally choose &amp;quot;Options/Reload Firewalld&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="misc"></category><category term="laravel"></category><category term="vagrant"></category></entry><entry><title>Primer post</title><link href="https://nbicalcarata.github.io/primer-post.html" rel="alternate"></link><published>2013-12-17T01:31:38-06:00</published><updated>2013-12-17T01:31:38-06:00</updated><author><name>Adrián Martínez</name></author><id>tag:nbicalcarata.github.io,2013-12-17:/primer-post.html</id><summary type="html"></summary><content type="html">&lt;p&gt;Decidi hacerme un blog y éste es mi primer post.&lt;/p&gt;
</content><category term="misc"></category><category term="python"></category></entry></feed>